;/*FB_PKG_DELIM*/

__d("WAWebMessageLabelDeprecationUtils",["WALogger","WAWebABProps","WAWebMobilePlatforms"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-label-deprecation] invalid max volume: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[message-label-deprecation] invalid deprecation phase: ",""]);i=function(){return a};return a}function a(){if(!d("WAWebMobilePlatforms").isSMB())return 0;var a=d("WAWebABProps").getABPropConfigValue("smb_message_label_deprecation_phase");switch(a){case 0:case 1:case 2:case 3:return a;default:d("WALogger").ERROR(i(),a);return 0}}function b(){return d("WAWebABProps").getABPropConfigValue("smb_message_label_deprecation_chat_list_banner_cool_down_seconds")}function c(){return d("WAWebABProps").getABPropConfigValue("smb_message_label_deprecation_target_date")}function e(){var a=parseInt(d("WAWebABProps").getABPropConfigValue("smb_message_label_deprecation_max_volume"),10);if(a<0||isNaN(a)){d("WALogger").ERROR(h(),a);return 0}return a}g.getMessageLabelDeprecationPhase=a;g.getMessageLabelDeprecationBannerCoolDownSeconds=b;g.getMessageLabelDeprecationTargetDate=c;g.getMessageLabelDeprecationMaxVolume=e}),98);
__d("WAWebLabelsUtil",["WAWebBizGatingUtils","WAWebChatThreadLogging","WAWebL10N","WAWebMessageLabelDeprecationUtils","WAWebMsgModel","WAWebWamEnumLabelOperations","WAWebWamEnumLabelTargets","WAWebWamLabelEventReporter","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){function h(a,b){d("WAWebWamLabelEventReporter").logLabelOperationEvent(d("WAWebWamEnumLabelOperations").LABEL_OPERATIONS.CLICK_POSITIVE,a,d("WAWebWamEnumLabelTargets").LABEL_TARGETS.LABEL_COMBINED_DIALOG,b==null?void 0:b)}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.length;d("WAWebBizGatingUtils").isSMBEnhancedLoggingEnabled()?a.forEach(function(a){a=a instanceof d("WAWebMsgModel").Msg?a.id.toString():a.id.toJid();a=d("WAWebChatThreadLogging").getChatThreadIDHMAC(a);var c=function(a){return h(b,a)};void a.then(c)}):h(b)});return i.apply(this,arguments)}function e(){var a=Date.parse(d("WAWebMessageLabelDeprecationUtils").getMessageLabelDeprecationTargetDate());return isNaN(a)?Intl.DateTimeFormat(c("WAWebL10N").getFullLocale()).format(new Date("2024-12-31")):Intl.DateTimeFormat(c("WAWebL10N").getFullLocale()).format(a)}g.logLabelOperationEventsForModels=a;g.getMessageLabelDeprecationTargetDateLocalized=e}),98);
__d("WAWebWamEnumCtwaLabelTarget",[],(function(a,b,c,d,e,f){a=Object.freeze({CHAT:0,MESSAGE:1});f.CTWA_LABEL_TARGET=a}),66);
__d("WAWebWamEnumCtwaLabelType",[],(function(a,b,c,d,e,f){a=Object.freeze({NEW_ORDER:0,PENDING_PAYMENT:1,PAID:2,ORDER_COMPLETE:3,NEW_CUSTOMER:4,DELIVERED:5,LEAD:6,FOLLOW_UP:7,APPOINTMENT:8});f.CTWA_LABEL_TYPE=a}),66);
__d("WAWebCtwaLabelSignalWamEvent",["WAWebWamCodegenUtils","WAWebWamEnumCtwaLabelTarget","WAWebWamEnumCtwaLabelType"],(function(a,b,c,d,e,f,g){b=(a=d("WAWebWamCodegenUtils")).defineEvents({CtwaLabelSignal:[4662,{ctwaLabelSignalVersion:[1,a.TYPES.INTEGER],ctwaLabelTarget:[2,d("WAWebWamEnumCtwaLabelTarget").CTWA_LABEL_TARGET],ctwaLabelType:[3,d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE],deepLinkConversionData:[4,a.TYPES.STRING],deepLinkConversionSource:[5,a.TYPES.STRING],eventSharingSettingEnabled:[6,a.TYPES.BOOLEAN],globalSharingSettingEnabled:[7,a.TYPES.BOOLEAN],threadIdHmac:[8,a.TYPES.STRING]},[1,1,1],"regular"]},{CtwaLabelSignal:[]});g.CtwaLabelSignalWamEvent=b}),98);
__d("WAWebSmbMarkAsXLabelAction",["WALogger","WASmaxInBizSettingsEnums","WAWebBizGatingUtils","WAWebCTWAConstants","WAWebCTWADataSharingModel","WAWebChatModel","WAWebCommonCTWADataSharing","WAWebCtwaLabelSignalWamEvent","WAWebFrontendMsgGetters","WAWebLabelCollection","WAWebMsgModel","WAWebWamEnumCtwaLabelTarget","WAWebWamEnumCtwaLabelType"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ctwa][labels] logLabelAddedToMessageAction: chat is missing for a provided message"]);h=function(){return a};return a}var i=new Map([[(a=d("WAWebCTWAConstants")).ALLOWED_PREDEFINED_LABEL_IDS.NEW_ORDER,(b=d("WAWebWamEnumCtwaLabelType")).CTWA_LABEL_TYPE.NEW_ORDER],[a.ALLOWED_PREDEFINED_LABEL_IDS.PENDING_PAYMENT,b.CTWA_LABEL_TYPE.PENDING_PAYMENT],[a.ALLOWED_PREDEFINED_LABEL_IDS.PAID,b.CTWA_LABEL_TYPE.PAID],[a.ALLOWED_PREDEFINED_LABEL_IDS.ORDER_COMPLETE,b.CTWA_LABEL_TYPE.ORDER_COMPLETE]]),j={globalSharingSettingEnabled:!1},k=function(a){var b=d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue();switch(b){case d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"]:return{globalSharingSettingEnabled:!0,eventSharingSettingEnabled:a};case d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["false"]:return j;case d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE.notset:default:return null}},l=function(a,b,e){var f=c("WAWebCommonCTWADataSharing").getCTWAEligibilityFromChat(a);if(f==null||!d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForChats())return;b.forEach(function(a){a=babelHelpers["extends"]({ctwaLabelSignalVersion:1,ctwaLabelTarget:d("WAWebWamEnumCtwaLabelTarget").CTWA_LABEL_TARGET.CHAT,ctwaLabelType:a,deepLinkConversionSource:f.source},k(e));new(d("WAWebCtwaLabelSignalWamEvent").CtwaLabelSignalWamEvent)(a).commit()})},m=function(a,b,e){a=d("WAWebFrontendMsgGetters").getChat(a);if(!a){d("WALogger").ERROR(h());return}var f=c("WAWebCommonCTWADataSharing").getCTWAEligibilityFromChat(a);if(f==null||!d("WAWebBizGatingUtils").isSMBLabelsDataSharingEnabledForMessages())return;b.forEach(function(a){new(d("WAWebCtwaLabelSignalWamEvent").CtwaLabelSignalWamEvent)(babelHelpers["extends"]({ctwaLabelSignalVersion:1,ctwaLabelTarget:d("WAWebWamEnumCtwaLabelTarget").CTWA_LABEL_TARGET.MESSAGE,ctwaLabelType:a,deepLinkConversionSource:f.source},k(e))).commit()})};e=function(a,b,c){var e=[];b.forEach(function(a){a=d("WAWebLabelCollection").LabelCollection.get(a);a=a==null?void 0:a.predefinedId;if(a==null)return;var b=i.get(a);b!=null&&e.push(b);a===d("WAWebCTWAConstants").NEW_CUSTOMER_LABEL_ID&&d("WAWebBizGatingUtils").is3pdSignalNewCustomerEnabled()&&e.push(d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.NEW_CUSTOMER);a===d("WAWebCTWAConstants").FOLLOW_UP_LABEL_ID&&d("WAWebBizGatingUtils").is3pdLeadOptimisationLabelSignalsEnabled()&&e.push(d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.FOLLOW_UP);a===d("WAWebCTWAConstants").LEAD_LABEL_ID&&d("WAWebBizGatingUtils").is3pdLeadOptimisationLabelSignalsEnabled()&&e.push(d("WAWebWamEnumCtwaLabelType").CTWA_LABEL_TYPE.LEAD)});if(e.length===0)return;if(a[0]instanceof d("WAWebMsgModel").Msg){m(a[0],e,c);return}a.forEach(function(a){a instanceof d("WAWebChatModel").Chat&&l(a,e,c)})};g.logLabelSignalForModels=e}),98);
__d("WAWebBizManageLabelModal.react",["fbt","WASmaxInBizSettingsEnums","WAWebBizGatingUtils","WAWebButton.react","WAWebCTWADataSharingModel","WAWebCommonCTWADataSharing","WAWebDataSharingOptOutOrUpsell","WAWebDataSharingUpsellModel","WAWebDrawerHeader.react","WAWebLabelCollection","WAWebLabelsMultiSelectLabelList.react","WAWebLabelsUtil","WAWebModal.react","WAWebMultiSelection","WAWebSmb3pdConversionSignalAction","WAWebSmbMarkAsXLabelAction","WAWebStateUtils","WAWebWDSButton","react","useForceUpdate"],(function(a,b,c,d,e,f,g,h){var i,j;b=j||d("react");var k=i||(i=c("react")),l=b.useEffect,m=b.useMemo,n=b.useState,o={NONE_SELECTED:0,ALL_SELECTED:1,PARTIALLY_SELECTED:2},p=function(){return d("WAWebCTWADataSharingModel").CTWADataSharingModel.getValue()===d("WASmaxInBizSettingsEnums").ENUM_FALSE_NOTSET_TRUE["true"]};e=k.forwardRef(a);function a(a,b){a=babelHelpers["extends"]({},a);var e=n(p),f=e[0],g=e[1];l(function(){return function(){c("WAWebDataSharingUpsellModel").enableUpsell()}},[]);var i=a.modelsToUpdate,j=a.onLabelUpdateComplete,q=m(function(){return new(c("WAWebMultiSelection"))([],function(a){return a.id})},[]),r=m(function(){return new Set()},[]),s=c("useForceUpdate")(),t=m(function(){var a=function(){var a={};i.forEach(function(b){b=d("WAWebStateUtils").unproxy(b);b.labels&&b.labels.forEach(function(b){a[b]=a[b]?++a[b]:1})});return a};a=a();var b={};Object.entries(a).forEach(function(a){var c=a[0];a=a[1];if(a===i.length)b[c]=o.ALL_SELECTED;else if(a>0){b[c]=o.PARTIALLY_SELECTED;return}else b[c]=o.NONE_SELECTED});return b},[]);e=function(a){if(a==null)return;t[a]===o.PARTIALLY_SELECTED?r.add("{labelId}_changed"):r.has(a)?r["delete"](a):(t[a]==null&&d("WAWebBizGatingUtils").labelsEditingEnabled()&&(t[a]=o.ALL_SELECTED),r.add(a));s()};var u=function(){void d("WAWebLabelsUtil").logLabelOperationEventsForModels(i);var a=q.list,b=q.selected,c=[],e=[];a.forEach(function(a,d){b[d]&&c.push(a.id),e.push({id:a.id,type:b[d]?"add":"remove"})});d("WAWebLabelCollection").LabelCollection.addOrRemoveLabels(e,i);c.length>0&&(d("WAWebSmbMarkAsXLabelAction").logLabelSignalForModels(i,c,f),f&&d("WAWebSmb3pdConversionSignalAction").log3pdConversionSignalForChatsOrMessages(i,c));j()};u=k.jsx(c("WAWebButton.react"),{testid:void 0,type:"primary",disabled:r.size===0,onClick:u,children:h._("__JHASH__K-FdwULPt2J__JHASH__")},1);var v=k.jsx(c("WAWebButton.react"),{testid:void 0,type:"secondary",onClick:a.onCancel,children:h._("__JHASH__JomY4EcHzcJ__JHASH__")},0);v=k.jsxs(d("WAWebWDSButton").ButtonGroup,{direction:"horizontal",children:[v,u]});u=k.jsx(d("WAWebDrawerHeader.react").DrawerHeader,{title:h._("__JHASH__CqaGYmJHqZB__JHASH__"),type:d("WAWebDrawerHeader.react").DRAWER_HEADER_TYPE.POPUP,onCancel:a.onCancel});var w=c("WAWebCommonCTWADataSharing").shouldDisplayDataSharingLabelOptOutOrUpsell(i)?k.jsx(d("WAWebDataSharingOptOutOrUpsell").DataSharingOptOutOrUpsell,{checkboxValue:f,onCheckboxToggle:function(){return g(!f)},theme:"labels-opt-out"}):null;return k.jsxs(d("WAWebModal.react").Modal,{ref:b,type:d("WAWebModal.react").ModalTheme.LabelList,actions:v,title:u,children:[k.jsx(c("WAWebLabelsMultiSelectLabelList.react"),{onNewLabelAdded:a.onNewLabelAdded,shouldScrollIntoViewAndSelect:a.shouldScrollIntoViewAndSelect,initialLabelState:t,selectedLabels:q,renderContext:"label-selection",onMultiSelect:e}),w]})}a.displayName=a.name+" [from "+f.id+"]";b=e;g["default"]=b}),226);
__d("WAWebBizManageLabelFlow.react",["WAWebBizManageLabelModal.react","WAWebChatModel","WAWebWamEnumLabelOperations","WAWebWamEnumLabelTargets","WAWebWamLabelEventReporter","react","useLazyRef"],(function(a,b,c,d,e,f,g){var h,i;b=i||d("react");var j=h||(h=c("react")),k=b.useEffect,l=b.useRef;function a(a){var b=a.modelsToUpdate,e=a.onClose,f=a.onLabelUpdateComplete,g=c("useLazyRef")(function(){return new Set()}),h=l();k(function(){var a=b.length;h.current=a===1?b[0]instanceof d("WAWebChatModel").Chat?d("WAWebWamEnumLabelTargets").LABEL_TARGETS.LABEL_CHAT_DIALOG:d("WAWebWamEnumLabelTargets").LABEL_TARGETS.LABEL_MESSAGE_DIALOG:d("WAWebWamEnumLabelTargets").LABEL_TARGETS.LABEL_COMBINED_DIALOG;d("WAWebWamLabelEventReporter").logLabelOperationEvent(d("WAWebWamEnumLabelOperations").LABEL_OPERATIONS.VIEW,a,h.current)},[]);a=function(a){if(g.current.has(a)){g.current["delete"](a);return{shouldScrollIntoView:!0,shouldSelect:!0}}return{shouldScrollIntoView:!1,shouldSelect:!1}};var i=function(a){g.current.add(a)},m=function(){f==null?void 0:f(),e==null?void 0:e()},n=function(){h.current&&d("WAWebWamLabelEventReporter").logLabelOperationEvent(d("WAWebWamEnumLabelOperations").LABEL_OPERATIONS.CLICK_NEGATIVE,b.length,h.current),e==null?void 0:e()};return j.jsx(c("WAWebBizManageLabelModal.react"),{shouldScrollIntoViewAndSelect:a,onLabelUpdateComplete:m,onCancel:n,onNewLabelAdded:i,modelsToUpdate:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);